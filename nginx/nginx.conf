events {}

http {
  server {
    listen 80;

    # --- NEW: Route for the Load Balancer health check ---
    # This sends requests for /health to the fast-starting backend.
    location /health {
      proxy_pass http://localhost:5000;
    }

    # --- Route for the application's API calls ---
    # This sends requests for /api/... to the backend.
    location /api/ {
      proxy_pass http://localhost:5000;
    }

    # --- Route for all other traffic (the user interface) ---
    # This sends all other requests to the slow-starting frontend.
    location / {
      proxy_pass http://localhost:3000;
    }
  }
}
